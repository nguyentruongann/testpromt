[
 {
  "absolute_value": 0,
  "align_labels_right": 0,
  "css": null,
  "custom_format": 1,
  "default_print_language": "en",
  "disabled": 0,
  "doc_type": "Sales Invoice",
  "docstatus": 0,
  "doctype": "Print Format",
  "font": null,
  "font_size": 14,
  "format_data": null,
  "html": "<!DOCTYPE html>\n<html lang=\"vi\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Hóa Đơn Trả Hàng</title>\n    <style>\n        * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n        }\n\n        body {\n            font-family: 'Courier New', monospace;\n            font-size: 18px; /* Increased from 14px */\n            line-height: 1.3;\n            color: #000;\n            background: #fff;\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            min-height: 100vh;\n        }\n\n        .receipt {\n            width: 80mm;\n            max-width: 300px;\n            margin: 0 auto;\n            padding: 15px 8px;\n            background: white;\n        }\n\n        .header {\n            text-align: center; /* Original centering preserved */\n            margin-bottom: 10px;\n        }\n\n        .store-name {\n            font-weight: bold;\n            font-size: 20px; /* Increased from 16px */\n            margin-bottom: 3px;\n        }\n\n        .branch-info,\n        .phone {\n            font-size: 17px; /* Increased from 13px */\n            margin-bottom: 2px;\n        }\n\n        .phone {\n            margin-bottom: 10px;\n        }\n\n        .divider {\n            border-bottom: 1px dashed #000;\n            margin: 8px 0;\n        }\n\n        .date-time {\n            font-size: 17px; /* Increased from 13px */\n            margin-bottom: 10px;\n        }\n\n        .invoice-title {\n            text-align: center; /* Original centering preserved */\n            font-weight: bold;\n            font-size: 19px; /* Increased from 15px */\n            margin: 10px 0;\n        }\n\n        .customer-info div {\n            font-size: 17px; /* Increased from 13px */\n            margin-bottom: 2px;\n            white-space: nowrap;\n            overflow: hidden;\n            text-overflow: ellipsis;\n            word-wrap: break-word;\n        }\n\n        .items-header {\n            display: flex;\n            justify-content: space-between; /* Original layout preserved */\n            font-size: 17px; /* Increased from 13px */\n            font-weight: bold;\n            margin: 10px 0 6px;\n            padding-bottom: 3px;\n        }\n\n        .item {\n            margin-bottom: 6px;\n        }\n\n        .item-name {\n            font-size: 17px; /* Increased from 13px */\n            margin-bottom: 2px;\n            word-wrap: break-word;\n        }\n\n        .item-details {\n            display: flex;\n            justify-content: space-between; /* Original layout preserved */\n            font-size: 17px; /* Increased from 13px */\n            align-items: center;\n        }\n\n        .section-title {\n            font-weight: bold;\n            margin: 10px 0 6px;\n            font-size: 17px; /* Increased from 13px */\n        }\n\n        .total-section {\n            margin-top: 10px;\n            border-top: 1px dashed #000;\n            padding-top: 6px;\n        }\n\n        .total-line {\n            display: flex;\n            justify-content: space-between; /* Original layout preserved */\n            font-size: 17px; /* Increased from 13px */\n            margin-bottom: 3px;\n        }\n\n        .total-final {\n            font-weight: bold;\n        }\n\n        .amount {\n            text-align: right; /* Original alignment preserved */\n            min-width: 80px;\n        }\n\n        @media print {\n            body {\n                margin: 0;\n                padding: 0;\n                display: flex;\n                justify-content: center;\n                align-items: center;\n                min-height: 100%;\n            }\n\n            .receipt {\n                width: 80mm;\n                margin: 0 auto;\n                padding: 3mm;\n            }\n        }\n    </style>\n</head>\n<body>\n    <div class=\"receipt\">\n        <!-- Header -->\n        <div class=\"header\">\n            <div class=\"store-name\">TÊN CỬA HÀNG</div>\n            <div class=\"branch-info\">Chi nhánh: {% set branch = frappe.db.get_value(\"DefaultValue\", {\"parent\": frappe.session.user, \"defkey\": \"branch\"}, \"defvalue\") %}\n{{ branch if branch else \"\" }}</div>\n            \n            <div class=\"phone\">Điện thoại: {{ doc.contact_mobile or \"N/A\" }}</div>\n        </div>\n\n        <div class=\"divider\"></div>\n\n        <!-- Date and Time -->\n        <div class=\"date-time\">\n            <div>Ngày bán: {{ frappe.utils.getdate(doc.posting_date).strftime('%d/%m/%Y') if doc.posting_date else \"\" }}</div>\n            <div>Giờ bán: {{ frappe.utils.get_time(doc.posting_time).strftime('%H:%M') if doc.posting_time else \"\" }}</div>\n        </div>\n\n        <!-- Invoice Title -->\n        {% if doc.is_return %}\n            <div class=\"invoice-title\">Hóa Đơn Trả Hàng</div>\n        {% else %}\n            <div class=\"invoice-title\">Hóa Đơn Bán Hàng</div>\n        {% endif %}\n\n        <!-- Customer Info -->\n        <div class=\"customer-info\">\n            <div>Khách hàng: {{ doc.customer_name|trim if doc.customer_name else \"N/A\" }}</div>\n            <div>Địa chỉ: {{ doc.address_display|replace('<br>', ' ')|replace('\\n', ' ')|replace('\\r', '')|trim if doc.address_display else \"N/A\" }}</div>\n            <div>Khu vực: {{ doc.territory|trim if doc.territory else \"N/A\" }}</div>\n            <div>Người bán: {{ doc.custom_seller if doc.custom_seller else \"N/A\" }}</div>\n        </div>\n\n        <div class=\"divider\"></div>\n\n        {% if doc.is_return %}\n            {% set original_invoice = frappe.get_doc(\"Sales Invoice\", doc.return_against) %}\n\n            <!-- PHẦN 1: SẢN PHẨM GỐC -->\n            <div class=\"items-header\">\n                <span>Đơn giá</span>\n                <span>SL</span>\n                <span>Thành tiền</span>\n            </div>\n\n            {% for return_item in doc.items %}\n                {% if return_item.sales_invoice_item %}\n                    {% for orig_item in original_invoice.items %}\n                        {% if orig_item.name == return_item.sales_invoice_item %}\n                            <div class=\"item\">\n                                <div class=\"item-name\">{{ orig_item.item_name }} ({{ orig_item.item_code }})</div>\n                                <div class=\"item-details\">\n                                    <span class=\"amount\">{{ orig_item.rate|round|int }}</span>\n                                    <span>{{ orig_item.qty|int }}</span>\n                                    <span class=\"amount\">{{ orig_item.amount|round|int }}</span>\n                                </div>\n                            </div>\n                        {% endif %}\n                    {% endfor %}\n                {% endif %}\n            {% endfor %}\n\n            <div class=\"divider\"></div>\n\n            <!-- PHẦN 2: SẢN PHẨM ĐỔI TRẢ -->\n            <div class=\"items-header\">\n                <span>Đơn giá</span>\n                <span>SL</span>\n                <span>Thành tiền</span>\n            </div>\n\n            {% for item in doc.items %}\n                {% if item.qty < 0 %}\n                    <div class=\"item\">\n                        <div class=\"item-name\">{{ item.item_name }} ({{ item.item_code }})</div>\n                        <div class=\"item-details\">\n                            <span class=\"amount\">{{ item.rate|round|int }}</span>\n                            <span>{{ (item.qty * -1)|int }}</span>\n                            <span class=\"amount\">{{ (item.amount * -1)|round|int }}</span>\n                        </div>\n                    </div>\n                {% endif %}\n            {% endfor %}\n\n        {% else %}\n            <!-- Hóa đơn bình thường -->\n            <div class=\"items-header\">\n                <span>Đơn giá</span>\n                <span>SL</span>\n                <span>Thành tiền</span>\n            </div>\n\n            {% for item in doc.items %}\n                <div class=\"item\">\n                    <div class=\"item-name\">{{ item.item_name }} ({{ item.item_code }})</div>\n                    <div class=\"item-details\">\n                        <span class=\"amount\">{{ item.rate|round|int }}</span>\n                        <span>{{ item.qty|int }}</span>\n                        <span class=\"amount\">{{ item.amount|round|int }}</span>\n                    </div>\n                </div>\n            {% endfor %}\n        {% endif %}\n\n        <!-- Totals -->\n        <div class=\"total-section\">\n            {% if doc.is_return %}\n                <div class=\"total-line\">\n                    <span>Tổng tiền hóa đơn trả:</span>\n                    <span class=\"amount\">{{ original_invoice.grand_total|round|int }}</span>\n                </div>\n                <div class=\"total-line\">\n                    <span>Tổng tiền hóa đơn mua:</span>\n                    <span class=\"amount\">{{ (doc.grand_total * -1)|round|int }}</span>\n                </div>\n                <div class=\"total-line total-final\">\n                    <span>Tổng cộng:</span>\n                    <span class=\"amount\">{{ (original_invoice.grand_total - (doc.grand_total * -1))|round|int }}</span>\n                </div>\n                <div class=\"total-line\">\n                    <span>Tiền trả khách:</span>\n                    <span class=\"amount\">{{ (original_invoice.grand_total - (doc.grand_total * -1))|round|int }}</span>\n                </div>\n            {% endif %}\n        </div>\n    </div>\n</body>\n</html>\n",
  "line_breaks": 0,
  "margin_bottom": 15.0,
  "margin_left": 15.0,
  "margin_right": 15.0,
  "margin_top": 15.0,
  "modified": "2025-07-08 16:51:29.777394",
  "module": "Accounts",
  "name": "Sales Invoice",
  "page_number": "Hide",
  "pdf_generator": "wkhtmltopdf",
  "print_format_builder": 0,
  "print_format_builder_beta": 0,
  "print_format_type": "Jinja",
  "raw_commands": null,
  "raw_printing": 0,
  "show_section_headings": 0,
  "standard": "No"
 }
]